<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log Meal - UOPO</title>
    <style>
        /* ... (Keep your existing UOPO styles here; unchanged from your last version) ... */
        /* Only important addition is for the live photo preview */
        #photo-preview img {
            max-width: 80%;
            border-radius: 12px;
            margin: 12px 0;
            box-shadow: 0 6px 18px #c7ad83;
        }
    </style>
</head>
<body>
    <nav>
        <div class="logo">üåæ UOPO</div>
        <div>
            <a href="dashboard.html">Dashboard</a>
            <a href="family-profiles.html">Family</a>
            <a href="diet-tracker.html">Diet Tracker</a>
            <a href="signin.html">Sign Out</a>
        </div>
    </nav>
    <div class="container">
        <div class="page-header">
            <h1>üì∑ Log Your Meal</h1>
            <p>Choose how you'd like to log your meal</p>
        </div>
        <div class="card">
            <h2>Select Logging Method</h2>
            <div class="method-selector">
                <div class="method-btn active" onclick="selectMethod('camera')">
                    <div style="font-size: 32px; margin-bottom: 10px;">üì∏</div>
                    <div style="font-weight: 600;">Camera Scanner</div>
                    <div style="font-size: 12px; color: #9B8B7E; margin-top: 5px;">Scan with camera</div>
                </div>
                <div class="method-btn" onclick="selectMethod('manual')">
                    <div style="font-size: 32px; margin-bottom: 10px;">‚úèÔ∏è</div>
                    <div style="font-weight: 600;">Manual Entry</div>
                    <div style="font-size: 12px; color: #9B8B7E; margin-top: 5px;">Type details</div>
                </div>
            </div>
        </div>

        <!-- Updated camera section: now real photo input -->
        <div id="camera-section" class="card">
            <h2>üì∏ Camera Scanner</h2>
            <div style="background: #FEF8F0; padding: 40px; border-radius: 8px; border: 2px dashed #D4A574; text-align: center; margin-bottom: 20px;">
                <input type="file" id="take-photo" accept="image/*" capture="environment" style="display:none;" onchange="processPhoto(this)">
                <button class="btn" onclick="document.getElementById('take-photo').click()">üì∑ Take a Photo</button>
                <div id="photo-preview"></div>
            </div>
        </div>

        <div id="manual-section" class="card" style="display: none;">
            <h2>‚úèÔ∏è Manual Entry</h2>
            <div class="form-group">
                <label for="food-name">Food Name</label>
                <input type="text" id="food-name" placeholder="e.g., Chicken Biryani">
            </div>
            <div class="form-group">
                <label for="portion">Portion Size</label>
                <input type="text" id="portion" placeholder="e.g., 250g or 1 bowl">
            </div>
            <div class="form-group">
                <label for="meal-time">Meal Time</label>
                <select id="meal-time">
                    <option value="">Select Meal Time</option>
                    <option value="breakfast">üåÖ Breakfast</option>
                    <option value="lunch">‚òÄÔ∏è Lunch</option>
                    <option value="dinner">üåô Dinner</option>
                    <option value="snack">üçé Snack</option>
                </select>
            </div>
            <button class="btn" onclick="logManualMeal()">‚úì Log Meal</button>
        </div>

        <div class="card">
            <h2>üìÖ Recent Meals Today</h2>
            <div class="recent-meals">
                <div class="meal-entry">
                    <div class="meal-time">üåÖ Breakfast - 8:30 AM</div>
                    <div class="meal-details">Idli with Sambar (2 idlis) ‚Ä¢ 120 cal</div>
                </div>
                <div class="meal-entry">
                    <div class="meal-time">‚òÄÔ∏è Lunch - 1:00 PM</div>
                    <div class="meal-details">Chicken Biryani (1 plate) ‚Ä¢ 450 cal</div>
                </div>
                <div class="meal-entry">
                    <div class="meal-time">üçé Snack - 5:00 PM</div>
                    <div class="meal-details">Tea with biscuits ‚Ä¢ 150 cal</div>
                </div>
            </div>
        </div>
    </div>
    <script>
        function selectMethod(method) {
            document.querySelectorAll('.method-btn').forEach(btn => btn.classList.remove('active'));
            event.target.closest('.method-btn').classList.add('active');
            document.getElementById('camera-section').style.display = (method === 'camera') ? 'block' : 'none';
            document.getElementById('manual-section').style.display = (method === 'manual') ? 'block' : 'none';
        }
        function processPhoto(input) {
            const photoPreview = document.getElementById('photo-preview');
            photoPreview.innerHTML = '';
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    // Show live preview
                    photoPreview.innerHTML = `<img src="${e.target.result}">`;
                    // Save image to sessionStorage
                    sessionStorage.setItem('mealPhoto', e.target.result);
                    setTimeout(() => window.location.href = "scan-result.html", 1200);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        function logManualMeal() {
            const foodName = document.getElementById('food-name').value;
            const mealTime = document.getElementById('meal-time').value;
            if (!foodName || !mealTime) {
                alert('Please fill in all fields');
                return;
            }
            alert(`‚úì Meal logged: ${foodName}`);
            window.location.href = 'dashboard.html';
        }
    </script>
</body>
</html>
